<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Flexible robot arm · ControlSystemIdentification Documentation</title><meta name="title" content="Flexible robot arm · ControlSystemIdentification Documentation"/><meta property="og:title" content="Flexible robot arm · ControlSystemIdentification Documentation"/><meta property="twitter:title" content="Flexible robot arm · ControlSystemIdentification Documentation"/><meta name="description" content="Documentation for ControlSystemIdentification Documentation."/><meta property="og:description" content="Documentation for ControlSystemIdentification Documentation."/><meta property="twitter:description" content="Documentation for ControlSystemIdentification Documentation."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ControlSystemIdentification Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../iddata/">Identification data</a></li><li><a class="tocitem" href="../../input_signals/">Input signal generation</a></li><li><a class="tocitem" href="../../ss/">State-space estimation</a></li><li><a class="tocitem" href="../../tf/">Transfer-function estimation</a></li><li><a class="tocitem" href="../../impulse/">Impulse-response estimation</a></li><li><a class="tocitem" href="../../freq/">Frequency-domain estimation</a></li><li><a class="tocitem" href="../../validation/">Validation</a></li><li><a class="tocitem" href="../../nonlinear/">Nonlinear identification</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../temp/">Temperature control</a></li><li><a class="tocitem" href="../closed_loop_id/">Identification in closed loop</a></li><li><a class="tocitem" href="../unstable_systems/">Identification of unstable systems</a></li><li><a class="tocitem" href="../delayest/">Delay estimation</a></li><li><a class="tocitem" href="../ballandbeam/">Ball and beam</a></li><li class="is-active"><a class="tocitem" href>Flexible robot arm</a></li><li><a class="tocitem" href="../glass_furnace/">Glass furnace</a></li><li><a class="tocitem" href="../evaporator/">Evaporator</a></li><li><a class="tocitem" href="../hair_dryer/">Hair dryer</a></li><li><a class="tocitem" href="../varx/">VARX model</a></li><li><a class="tocitem" href="../hammerstein_wiener/">Nonlinear belt drive</a></li><li><a class="tocitem" href="../modelingtoolkit/">Fit parameters of ModelingToolkit model</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Flexible robot arm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Flexible robot arm</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/baggepinnen/ControlSystemIdentification.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/master/docs/src/examples/flexible_robot.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>In this example, we will estimate a model for a flexible robot arm. </p><p>We will get the data from <a href="https://homes.esat.kuleuven.be/~smc/daisy/daisydata.html">STADIUS&#39;s Identification Database</a></p><pre><code class="language-julia hljs">using DelimitedFiles, Plots
using ControlSystemIdentification, ControlSystemsBase

url = &quot;https://ftp.esat.kuleuven.be/pub/SISTA/data/mechanical/robot_arm.dat.gz&quot;
zipfilename = &quot;/tmp/flex.dat.gz&quot;
path = Base.download(url, zipfilename)
run(`gunzip -f $path`)
data = readdlm(path[1:end-3])
u = data[:, 1]&#39; # torque
y = data[:, 2]&#39; # acceleration
d = iddata(y, u, 0.01) # sample time not specified for data, 0.01 is a guess</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">InputOutput data of length 1024, 1 outputs, 1 inputs, Ts = 0.01</code></pre><p>The input consists of the motor torque and the output is the acceleration of the arm. </p><p>Before we estimate any model, we inspect the data and the coherence function</p><pre><code class="language-julia hljs">xt = [2,5,10,20,50]
plot(
    plot(d),
    coherenceplot(d, xticks=(xt,xt), hz=true),
)</code></pre><img src="e4a7ea0f.svg" alt="Example block output"/><p>The coherence is low for high frequencies as well as frequencies between 2 and 6 Hz. We should thus be careful with relying on the estimated model too much in these frequency ranges. The reason for the low coherence may be either a poor signal-to-noise ratio, or the presence of nonlinearities. For systems with anti-resonances, like this one, the SNR is often poor at the notch frequencies (indeed, a notch frequency is defined as a frequency where there will be very little signal). We can investigate the spectra of the input and output using <a href="../../api/#ControlSystemIdentification.welchplot"><code>welchplot</code></a> (see also <a href="../../api/#ControlSystemIdentification.specplot"><code>specplot</code></a>)</p><pre><code class="language-julia hljs">welchplot(d, yticks=(xt,xt))</code></pre><img src="abfdd0ae.svg" alt="Example block output"/><p>Not surprisingly, we see that the input has very little power above 20Hz, this is the reason for the low coherence above 20Hz. Limiting the bandwidth of the excitation signal is usually a good thing, mechanical structures often exhibit higher-order resonances and nonlinear behavior at high frequencies, which we see eveidence of in the output spectrum at around 34Hz.</p><p>We also split the data in half, and use the first half for estimation and the second for validation. We&#39;ll use a subspace-based identification algorithm for estimation</p><pre><code class="language-julia hljs">dtrain = d[1:end÷2]
dval = d[end÷2:end]

# A model of order 4 is reasonable, a double-mass model. We estimate two models, one using subspace-based identification and one using the prediction-error method
using Optim
model_ss = subspaceid(dtrain, 4, focus=:prediction)
model_pem, x0_pem = newpem(dtrain, 4; focus=:prediction, optimizer=NelderMead(), iterations=100000, show_every=50000)

predplot(model_ss, dval, h=1)
predplot!(model_ss, dval, h=5, ploty=false)
simplot!(model_ss, dval, ploty=false)</code></pre><img src="af444454.svg" alt="Example block output"/><p>The figures above show the result of predicting <span>$h={1, 10, \infty}$</span> steps into the future.</p><p>We can visualize the estimated models in the frequency domain as well. We show both the model estimated using PEM and a nonparametric estimate using a Fourier-based method (<a href="../../freq/#ControlSystemIdentification.tfest"><code>tfest</code></a>), this method estimates a noise model as well.</p><pre><code class="language-julia hljs">w = exp10.(LinRange(-1, log10(pi/d.Ts), 200))
bodeplot(model_pem.sys, w, lab=&quot;PEM&quot;, plotphase=false, hz=true)
bodeplot!(model_ss.sys, w, lab=&quot;Subspace&quot;, plotphase=false, hz=true)
plot!(tfest(d), legend=:bottomleft, hz=true, xticks=(xt,xt))</code></pre><img src="d21483e7.svg" alt="Example block output"/><p>It looks like the model fails to capture the notches accurately. Estimating zeros is known to be hard, both in practice and in theory. In the estimated disturbance (labeled <em>Noise</em>), we see a peak at around 34Hz. This is likely an overtone due to nonlinearities.</p><p>We can also investigate how well the models predict for various prediction horizons, and compare that to how well the model does in open loop (simulation)</p><pre><code class="language-julia hljs">using Statistics
hs = [1:40; 45:5:80]
perrs_pem = map(hs) do h
    yh = predict(model_pem, d, x0_pem; h)
    ControlSystemIdentification.rms(d.y - yh) |&gt; mean
end
perrs_ss = map(hs) do h
    yh = predict(model_ss, d; h)
    ControlSystemIdentification.rms(d.y - yh) |&gt; mean
end
serr_pem = ControlSystemIdentification.rms(d.y - simulate(model_pem, d)) |&gt; mean
serr_ss = ControlSystemIdentification.rms(d.y - simulate(model_ss, d)) |&gt; mean

plot(hs, perrs_pem, lab=&quot;Prediction errors PEM&quot;, xlabel=&quot;Prediction Horizon&quot;, ylabel=&quot;RMS error&quot;)
plot!(hs, perrs_ss, lab=&quot;Prediction errors Subspace&quot;)
hline!([serr_pem], lab=&quot;Simulation error PEM&quot;, l=:dash, c=1, ylims=(0, Inf))
hline!([serr_ss], lab=&quot;Simulation error Subspace&quot;, l=:dash, c=2, legend=:bottomright, ylims=(0, Inf))</code></pre><img src="b9fddee6.svg" alt="Example block output"/><p>We see that the prediction-error model does well at prediction few-step predictions (indeed, this is what PEM optimizes), while the model identified using <code>subspaceid</code> does better in open loop. The simulation performance can be improved upon further by asking for <code>focus=:prediction</code> when the models are estimated.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ballandbeam/">« Ball and beam</a><a class="docs-footer-nextpage" href="../glass_furnace/">Glass furnace »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 29 January 2026 14:10">Thursday 29 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
