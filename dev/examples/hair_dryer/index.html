<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hair dryer · ControlSystemIdentification Documentation</title><meta name="title" content="Hair dryer · ControlSystemIdentification Documentation"/><meta property="og:title" content="Hair dryer · ControlSystemIdentification Documentation"/><meta property="twitter:title" content="Hair dryer · ControlSystemIdentification Documentation"/><meta name="description" content="Documentation for ControlSystemIdentification Documentation."/><meta property="og:description" content="Documentation for ControlSystemIdentification Documentation."/><meta property="twitter:description" content="Documentation for ControlSystemIdentification Documentation."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ControlSystemIdentification Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../iddata/">Identification data</a></li><li><a class="tocitem" href="../../ss/">State-space estimation</a></li><li><a class="tocitem" href="../../tf/">Transfer-function estimation</a></li><li><a class="tocitem" href="../../impulse/">Impulse-response estimation</a></li><li><a class="tocitem" href="../../freq/">Frequency-domain estimation</a></li><li><a class="tocitem" href="../../validation/">Validation</a></li><li><a class="tocitem" href="../../nonlinear/">Nonlinear identification</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../temp/">Temperature control</a></li><li><a class="tocitem" href="../closed_loop_id/">Identification in closed loop</a></li><li><a class="tocitem" href="../unstable_systems/">Identification of unstable systems</a></li><li><a class="tocitem" href="../delayest/">Delay estimation</a></li><li><a class="tocitem" href="../ballandbeam/">Ball and beam</a></li><li><a class="tocitem" href="../flexible_robot/">Flexible robot arm</a></li><li><a class="tocitem" href="../glass_furnace/">Glass furnace</a></li><li><a class="tocitem" href="../evaporator/">Evaporator</a></li><li class="is-active"><a class="tocitem" href>Hair dryer</a></li><li><a class="tocitem" href="../varx/">VARX model</a></li><li><a class="tocitem" href="../hammerstein_wiener/">Nonlinear belt drive</a></li><li><a class="tocitem" href="../modelingtoolkit/">Fit parameters of ModelingToolkit model</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Hair dryer</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hair dryer</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/baggepinnen/ControlSystemIdentification.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/master/docs/src/examples/hair_dryer.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>In this example, we will estimate a model for a laboratory setup acting like a hair dryer. Air is fanned through a tube and heated at the inlet. The air temperature is measured by a thermocouple at the output. The input is the voltage over the heating device (a mesh of resistor wires).</p><p>The example comes from <a href="https://homes.esat.kuleuven.be/~smc/daisy/daisydata.html">STADIUS&#39;s Identification Database</a>.</p><p>An extension to this example where an MPC controller is designed for the estimated system can be found <a href="https://help.juliahub.com/juliasimcontrol/dev/examples/sysid_mpc/">here</a>, as well as in video form <a href="https://www.youtube.com/watch?v=z8o83UORuqQ&amp;ab_channel=JuliaHub">here</a>.</p><blockquote><p>Ljung L.  System identification - Theory for the User. Prentice Hall, Englewood Cliffs, NJ, 1987. </p></blockquote><pre><code class="language-julia hljs">using DelimitedFiles, Plots
using ControlSystemIdentification, ControlSystemsBase

url = &quot;https://ftp.esat.kuleuven.be/pub/SISTA/data/mechanical/dryer.dat.gz&quot;
zipfilename = &quot;/tmp/dryer.dat.gz&quot;
path = Base.download(url, zipfilename)
run(`gunzip -f $path`)
data = readdlm(path[1:end-3])
u = data[:, 1]&#39; # voltage
y = data[:, 2]&#39; # air temp
d = iddata(y, u, 0.08) # sample time not specified for data, 0.08 is a guess</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">InputOutput data of length 1000, 1 outputs, 1 inputs, Ts = 0.08</code></pre><p>The input consists of the voltage to the heating element and the output is the air temperature</p><p>Before we estimate any model, we inspect the data and the coherence function</p><pre><code class="language-julia hljs">plot(
    plot(d),
    coherenceplot(d),
)</code></pre><img src="b9d4fedf.svg" alt="Example block output"/><p>The coherence looks good up until about 10 rad/s, above this frequency we can not trust the model. We notice that the data is not zero centered, and thus remove the mean before continuing (remember to correctly handle the operating point when controlling a process). If we look at an estimated impulse response</p><pre><code class="language-julia hljs">d = detrend(d)
impulseestplot(d, 40, σ=3)</code></pre><img src="096d30c4.svg" alt="Example block output"/><p>we see that there is a three step input delay. </p><p>Before we estimate models, we split the data in a estimation set and a validation set. We then estimate two different models, one using hte prediction-error method (<a href="../../ss/#ControlSystemIdentification.newpem"><code>newpem</code></a>) and one using standard least-squares (<a href="../../tf/#ControlSystemIdentification.arx"><code>arx</code></a>). When we estimate the ARX model, we tell the estimator that we have a known input delay of 3 samples. We then validate the estimated models by using them for prediction and simulation on the validation data.</p><pre><code class="language-julia hljs">dtrain = d[1:end÷2]
dval = d[end÷2:end]
## A model of order 3 is reasonable.
model_pem,_ = newpem(dtrain, 3)
model_arx = arx(dtrain, 2, 2, inputdelay=3)

predplot(model_pem, dval, sysname=&quot;PEM&quot;)
predplot!(model_arx, dval, ploty=false, sysname=&quot;ARX&quot;)
simplot!(model_pem, dval, ploty=false, sysname=&quot;PEM&quot;)
simplot!(model_arx, dval, ploty=false, sysname=&quot;ARX&quot;)</code></pre><img src="12721be2.svg" alt="Example block output"/><p>The models are roughly comparable, where the PEM model is slightly better at prediction while the ARX model is slightly better at simulation. Note, <a href="../../ss/#ControlSystemIdentification.newpem"><code>newpem</code></a> takes a keyword argument <code>focus</code> that can be set to <code>focus = :simulation</code> in order to improve simulation performance.</p><p>To finalize, we compare the models in the frequency domain to a nonparametric estimate of the transfer function made with Fourier-based methods (<a href="../../freq/#ControlSystemIdentification.tfest"><code>tfest</code></a>):</p><pre><code class="language-julia hljs">w = exp10.(LinRange(-1, log10(pi/d.Ts), 200))
bodeplot(model_pem.sys, w, lab=&quot;PEM&quot;, plotphase=false)
bodeplot!(model_arx, w, lab=&quot;ARX&quot;, plotphase=false)
plot!(tfest(d))</code></pre><img src="aafeb6e1.svg" alt="Example block output"/><p>The two parametric models are quite similar and agree well with the nonparametric estimate. We also see that the nonparametric estimate becomes rather noisy above 10 rad/s, something we could predict based on the coherence function.</p><p>We can compare the impulse responses of the estimated model to the impulse response that was estimated directly from data above:</p><pre><code class="language-julia hljs">impulseestplot(d, 40, σ=3, lab=&quot;Data&quot;, seriestype=:steppost)
plot!(impulse(model_pem, 3), lab=&quot;PEM&quot;)
plot!(impulse(model_arx, 3), lab=&quot;ARX&quot;)</code></pre><img src="eab4e93c.svg" alt="Example block output"/><p>The ARX model has an impulse response that is exactly zero for the first three samples since we indicated <code>inputdelay=3</code> when estimating this model. The PEM model did not know this, but figured it out from the data nevertheless.</p><p>As a last step of validation, we perform residual analysis. If a model has extracted all available useful information from the data, the residuals should form a white-noise sequence, and there should be no correlation between the input and the residuals. To this end, we have the function <a href="../../api/#ControlSystemIdentification.residualplot"><code>residualplot</code></a>:</p><pre><code class="language-julia hljs">residualplot(model_pem, dval, lab=&quot;PEM&quot;)
residualplot!(model_arx, dval, lab=&quot;ARX&quot;)</code></pre><img src="3420e159.svg" alt="Example block output"/><p>As we can see, there is some slight correlation left in the residuals, the dashed black lines show 95% significance levels. This small amount of correlation is usually nothing to worry about if the model fit is high, i.e., the residuals are small, and we&#39;ll thus consider ourselves done at this point.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../evaporator/">« Evaporator</a><a class="docs-footer-nextpage" href="../varx/">VARX model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 13 February 2025 05:00">Thursday 13 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
