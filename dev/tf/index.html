<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transfer-function estimation · ControlSystemIdentification Documentation</title><meta name="title" content="Transfer-function estimation · ControlSystemIdentification Documentation"/><meta property="og:title" content="Transfer-function estimation · ControlSystemIdentification Documentation"/><meta property="twitter:title" content="Transfer-function estimation · ControlSystemIdentification Documentation"/><meta name="description" content="Documentation for ControlSystemIdentification Documentation."/><meta property="og:description" content="Documentation for ControlSystemIdentification Documentation."/><meta property="twitter:description" content="Documentation for ControlSystemIdentification Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ControlSystemIdentification Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../iddata/">Identification data</a></li><li><a class="tocitem" href="../ss/">State-space estimation</a></li><li class="is-active"><a class="tocitem" href>Transfer-function estimation</a><ul class="internal"><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Usage-example:"><span>Usage example:</span></a></li><li><a class="tocitem" href="#Time-series-modeling"><span>Time-series modeling</span></a></li><li><a class="tocitem" href="#Code-generation"><span>Code generation</span></a></li><li><a class="tocitem" href="#Transfer-function-API"><span>Transfer-function API</span></a></li><li><a class="tocitem" href="#Video-tutorials"><span>Video tutorials</span></a></li></ul></li><li><a class="tocitem" href="../impulse/">Impulse-response estimation</a></li><li><a class="tocitem" href="../freq/">Frequency-domain estimation</a></li><li><a class="tocitem" href="../validation/">Validation</a></li><li><a class="tocitem" href="../nonlinear/">Nonlinear identification</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/temp/">Temperature control</a></li><li><a class="tocitem" href="../examples/closed_loop_id/">Identification in closed loop</a></li><li><a class="tocitem" href="../examples/unstable_systems/">Identification of unstable systems</a></li><li><a class="tocitem" href="../examples/delayest/">Delay estimation</a></li><li><a class="tocitem" href="../examples/ballandbeam/">Ball and beam</a></li><li><a class="tocitem" href="../examples/flexible_robot/">Flexible robot arm</a></li><li><a class="tocitem" href="../examples/glass_furnace/">Glass furnace</a></li><li><a class="tocitem" href="../examples/evaporator/">Evaporator</a></li><li><a class="tocitem" href="../examples/hair_dryer/">Hair dryer</a></li><li><a class="tocitem" href="../examples/varx/">VARX model</a></li><li><a class="tocitem" href="../examples/hammerstein_wiener/">Nonlinear belt drive</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Transfer-function estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Transfer-function estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/baggepinnen/ControlSystemIdentification.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/master/docs/src/tf.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Transfer-function-estimation"><a class="docs-heading-anchor" href="#Transfer-function-estimation">Transfer function estimation</a><a id="Transfer-function-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Transfer-function-estimation" title="Permalink"></a></h1><p>This page documents how to estimate transfer functions, sometimes called ARX or ARMAX models, i.e. models on any of the forms</p><p class="math-container">\[\begin{aligned}
G(z) &amp;= \dfrac{B(z)}{A(z)} = \dfrac{b_m z^m + \dots + b_0}{z^n + a_{n-1} z^{n-1} + \dots + a_0} \\
Ay &amp;= Bu + w \\
Ay &amp;= Bu + Cw \\
Ay &amp;= Bu + 1/D w
\end{aligned}\]</p><p>This package estimates models in discrete time, but they may be converted to continuous-time models using the function <a href="https://juliacontrol.github.io/ControlSystems.jl/stable/lib/synthesis/#ControlSystemsBase.d2c"><code>d2c</code></a> from <a href="https://github.com/JuliaControl/ControlSystems.jl">ControlSystemsBase.jl</a>.</p><p>The methods available are:</p><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><ul><li><a href="#ControlSystemIdentification.arx"><code>arx</code></a>: Transfer-function estimation using least-squares fitting with a closed-form solution. Supports multiple datasets and custom estimator functions.</li><li><a href="#ControlSystemIdentification.arma"><code>arma</code></a>: Estimate an ARMA model (no control input).</li><li><a href="#ControlSystemIdentification.ar"><code>ar</code></a>: Estimate an AR model (no input).</li><li><a href="../api/#ControlSystemIdentification.arma_ssa-Tuple{ControlSystemIdentification.AbstractIdData, Any, Any}"><code>arma_ssa</code></a> Estimate an ARMA model with estimated noise as input (no control input).</li><li><a href="#ControlSystemIdentification.plr"><code>plr</code></a>: Transfer-function estimation (ARMAX model) using pseudo-linear regression. <a href="../api/#ControlSystemIdentification.armax"><code>armax</code></a> is an alias for this function. This method estimates a noise model as well.</li><li><a href="#ControlSystemIdentification.arxar"><code>arxar</code></a>: Transfer-function estimation using generalized least-squares method. This method estimates a noise model as well.</li><li><a href="#ControlSystemIdentification.getARXregressor"><code>getARXregressor</code></a>/<a href="#ControlSystemIdentification.getARregressor"><code>getARregressor</code></a>: For low-level control over the estimation</li></ul><p>See docstrings for further help.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Most methods for estimation of transfer functions handle SISO, SIMO or MISO systems only. For estimation of MIMO systems, consider using state-space based methods and convert the result to a transfer function using <code>tf</code> after estimation if required. </p></div></div><h2 id="Usage-example:"><a class="docs-heading-anchor" href="#Usage-example:">Usage example:</a><a id="Usage-example:-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-example:" title="Permalink"></a></h2><pre><code class="language-julia hljs">N  = 2000     # Number of time steps
t  = 1:N
Δt = 1        # Sample time
u  = randn(N) # A random control input
G  = tf(0.8, [1,-0.9], 1)
y  = lsim(G,u,t)[1][:]
yn = y
d  = iddata(y,u,Δt)

na,nb = 1,1   # Number of polynomial coefficients

Gls = arx(d,na,nb,stochastic=false) # set stochastic to true to get a transfer function of MonteCarloMeasurements.Particles
@show Gls
# TransferFunction{ControlSystemsBase.SisoRational{Float64}}
#     0.8000000000000005
# --------------------------
# 1.0*z - 0.8999999999999997</code></pre><p>As we can see, the model is perfectly recovered. In reality, the measurement signal is often affected by noise, in which case the estimation will suffer. To combat this, a few different options exist:</p><pre><code class="language-julia hljs">e  = randn(N)
yn = y + e    # Measurement signal with noise
d  = iddata(yn,u,Δt)

na,nb,nc = 1,1,1

Gls      = arx(d,na,nb, stochastic=true)     # Regular least-squares estimation
Gtls     = arx(d,na,nb, estimator=tls)       # Total least-squares estimation
Gwtls    = arx(d,na,nb, estimator=wtls_estimator(y,na,nb)) # Weighted Total least-squares estimation
Gplr, Gn = plr(d,na,nb,nc, initial_order=20) # Pseudo-linear regression
@show Gls; @show  Gtls; @show  Gwtls; @show  Gplr; @show  Gn;
# TransferFunction{ControlSystemsBase.SisoRational{MonteCarloMeasurements.Particles{Float64,500}}}
#     0.824 ± 0.029
# ---------------------
# 1.0*z - 0.713 ± 0.013

# Gtls = TransferFunction{ControlSystemsBase.SisoRational{Float64}}
#     1.848908051191616
# -------------------------
# 1.0*z - 0.774385918070221

# Gwtls = TransferFunction{ControlSystemsBase.SisoRational{Float64}}
#    0.8180228878106678
# -------------------------
# 1.0*z - 0.891939152690534

# Gplr = TransferFunction{ControlSystemsBase.SisoRational{Float64}}
#     0.8221837077656046
# --------------------------
# 1.0*z - 0.8896345125395438

# Gn = TransferFunction{ControlSystemsBase.SisoRational{Float64}}
#     0.9347035105826179
# --------------------------
# 1.0*z - 0.8896345125395438</code></pre><p>We now see that the estimate using standard least-squares is heavily biased and it is wrongly certain about the estimate (notice the ± in the transfer function coefficients). Regular Total least-squares does not work well in this example, since not all variables in the regressor contain equally much noise. Weighted total least-squares does a reasonable job at recovering the true model. Pseudo-linear regression also fares okay, while simultaneously estimating a noise model. The helper function <a href="../api/#ControlSystemIdentification.wtls_estimator"><code>wtls_estimator</code></a><code>(y,na,nb)</code> returns a function that performs <code>wtls</code> using appropriately sized covariance matrices, based on the length of <code>y</code> and the model orders. Weighted total least-squares estimation is provided by <a href="https://github.com/baggepinnen/TotalLeastSquares.jl">TotalLeastSquares.jl</a>. See the <a href="https://github.com/JuliaControl/ControlExamples.jl?files=1">example notebooks</a> for more details.</p><p>Uncertain transfer function with <code>Particles</code> coefficients can be used like any other model. Try, e.g., <code>nyquistplot(Gls)</code> to get a Nyquist plot with confidence bounds.</p><p>See also function <a href="#ControlSystemIdentification.arma"><code>arma</code></a> for estimation of signal models without inputs.</p><p>A video using the function <a href="#ControlSystemIdentification.arx"><code>arx</code></a> is available here:</p><iframe style="height: 315px; width: 560px" src="https://www.youtube.com/embed/HSx28O956kA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h2 id="Time-series-modeling"><a class="docs-heading-anchor" href="#Time-series-modeling">Time-series modeling</a><a id="Time-series-modeling-1"></a><a class="docs-heading-anchor-permalink" href="#Time-series-modeling" title="Permalink"></a></h2><p>Time-series modeling can be seen as special cases of transfer-function modeling where there are no control inputs. This package is primarily focused on control system identification, but we nevertheless provide two methods aimed at time-series estimation:</p><ul><li><a href="#ControlSystemIdentification.ar"><code>ar</code></a>: Estimate an AR model (no input).</li><li><a href="../api/#ControlSystemIdentification.arma_ssa-Tuple{ControlSystemIdentification.AbstractIdData, Any, Any}"><code>arma_ssa</code></a> Estimate an ARMA model with estimated noise as input (no control input).</li></ul><h2 id="Code-generation"><a class="docs-heading-anchor" href="#Code-generation">Code generation</a><a id="Code-generation-1"></a><a class="docs-heading-anchor-permalink" href="#Code-generation" title="Permalink"></a></h2><p>To generate C-code for, e.g., simulating a system or filtering through an estimated transfer function, see <a href="https://github.com/JuliaControl/SymbolicControlSystems.jl">SymbolicControlSystems.jl</a>.</p><h2 id="Transfer-function-API"><a class="docs-heading-anchor" href="#Transfer-function-API">Transfer-function API</a><a id="Transfer-function-API-1"></a><a class="docs-heading-anchor-permalink" href="#Transfer-function-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ControlSystemIdentification.arx" href="#ControlSystemIdentification.arx"><code>ControlSystemIdentification.arx</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Gtf = arx(d::AbstractIdData, na, nb; inputdelay = ones(Int, size(nb)), λ = 0, estimator=\, stochastic=false)</code></pre><p>Fit a transfer Function to data using an ARX model and equation error minimization.</p><ul><li><code>nb</code> and <code>na</code> are the number of coefficients of the numerator and denominator polynomials.</li></ul><p>Input delay can be added via <code>inputdelay = d</code>, which corresponds to an additional delay of <code>z^-d</code>. An <code>inputdelay = 0</code> results in a direct term. The highest order of the B polynomial is given by <code>nb + inputdelay - 1</code>.  <code>λ &gt; 0</code> can be provided for L₂ regularization. <code>estimator</code> defaults to \ (least squares), alternatives are <code>estimator = tls</code> for total least-squares estimation.  <code>arx(Δt,yn,u,na,nb, estimator=wtls_estimator(y,na,nb)</code> is potentially more robust in the presence of heavy measurement noise. The number of free parameters is <code>na+nb</code> </p><ul><li><code>stochastic</code>: if true, returns a transfer function with uncertain parameters represented by <code>MonteCarloMeasurements.Particles</code>.</li></ul><p>Supports MISO estimation by supplying an iddata with a matrix <code>u</code>, with nb = [nb₁, nb₂...] and optional inputdelay = [d₁, d₂...]</p><p>This function supports multiple datasets, provided as a vector of iddata objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/b79b5805b90329f11b8418827dfef527675483ca/src/arx.jl#L71-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ControlSystemIdentification.ar" href="#ControlSystemIdentification.ar"><code>ControlSystemIdentification.ar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ar(d::AbstractIdData, na; λ=0, estimator=\, scaleB=false, stochastic=false)</code></pre><p>Estimate an AR transfer function <code>G = 1/A</code>, the AR process is defined as <code>A(z⁻¹)y(t) = e(t)</code></p><p><strong>Arguments:</strong></p><ul><li><code>d</code>: IdData, see <a href="../iddata/#ControlSystemIdentification.iddata"><code>iddata</code></a></li><li><code>na</code>: order of the model</li><li><code>λ</code>: <code>λ &gt; 0</code> can be provided for L₂ regularization</li><li><code>estimator</code>: e.g. <code>\,tls,irls,rtls</code></li><li><code>scaleB</code>: Whether or not to scale the numerator using the variance of the prediction error.</li><li><code>stochastic</code>: if true, returns a transfer function with uncertain parameters represented by <code>MonteCarloMeasurements.Particles</code>.</li></ul><p>Estimation of AR models using least-squares is known to struggle with heavy measurement noise, using <code>estimator = tls</code> can improve the result in this case.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; N = 10000
10000

julia&gt; e = [-0.2; zeros(N-1)] # noise e
10000-element Vector{Float64}:
[...]

julia&gt; G = tf([1, 0], [1, -0.9], 1) # AR transfer function
TransferFunction{Discrete{Int64}, ControlSystemsBase.SisoRational{Float64}}
   1.0z
----------
1.0z - 0.9

Sample Time: 1 (seconds)
Discrete-time transfer function model

julia&gt; y = lsim(G, e, 1:N)[1][:] # Get output of AR transfer function from input noise e
10000-element Vector{Float64}:
[...]

julia&gt; Gest = ar(iddata(y), 1) # Estimate AR transfer function from output y
TransferFunction{Discrete{Float64}, ControlSystemsBase.SisoRational{Float64}}
          1.0z
-------------------------
1.0z - 0.8999999999999998

Sample Time: 1.0 (seconds)
Discrete-time transfer function model

julia&gt; G ≈ Gest # Test if estimation was correct
true

julia&gt; eest = lsim(1/Gest, y, 1:N)[1][:] # recover the input noise e from output y and estimated transfer function Gest
10000-element Vector{Float64}:
[...]

julia&gt; isapprox(eest, e, atol = eps()) # input noise correct recovered
true </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/b79b5805b90329f11b8418827dfef527675483ca/src/arx.jl#L222-L278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ControlSystemIdentification.arma" href="#ControlSystemIdentification.arma"><code>ControlSystemIdentification.arma</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">model = arma(d::AbstractIdData, na, nc; initial_order=20, method=:ls)</code></pre><p>Estimate a Autoregressive Moving Average model with <code>na</code> coefficients in the denominator and <code>nc</code> coefficients in the numerator. Returns the model and the estimated noise sequence driving the system.</p><p><strong>Arguments:</strong></p><ul><li><code>d</code>: iddata</li><li><code>initial_order</code>: An initial AR model of this order is used to estimate the residuals</li><li><code>estimator</code>: A function <code>(A,y)-&gt;minimizeₓ(Ax-y)</code> default is <code>\</code> but another option is <code>wtls_estimator(1:length(y)-initial_order,na,nc,ones(nc))</code></li></ul><p>See also <a href="../api/#ControlSystemIdentification.estimate_residuals-Tuple{Any, Any}"><code>estimate_residuals</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/b79b5805b90329f11b8418827dfef527675483ca/src/arx.jl#L583-L595">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ControlSystemIdentification.plr" href="#ControlSystemIdentification.plr"><code>ControlSystemIdentification.plr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">G, Gn = plr(d::AbstractIdData,na,nb,nc; initial_order = 20)</code></pre><p>Perform pseudo-linear regression to estimate a model on the form <code>Ay = Bu + Cw</code> The residual sequence is estimated by first estimating a high-order arx model, whereafter the estimated residual sequence is included in a second estimation problem. The return values are the estimated system model, and the estimated noise model. <code>G</code> and <code>Gn</code> will always have the same denominator polynomial.</p><p><code>armax</code> is an alias for <code>plr</code>. See also <a href="../api/#ControlSystemIdentification.pem-Tuple{Any}"><code>pem</code></a>, <a href="#ControlSystemIdentification.ar"><code>ar</code></a>, <a href="#ControlSystemIdentification.arx"><code>arx</code></a> and <a href="#ControlSystemIdentification.arxar"><code>arxar</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/b79b5805b90329f11b8418827dfef527675483ca/src/arx.jl#L539-L547">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ControlSystemIdentification.arxar" href="#ControlSystemIdentification.arxar"><code>ControlSystemIdentification.arxar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">G, H, e = arxar(d::InputOutputData, na::Int, nb::Union{Int, Vector{Int}}, nd::Int)</code></pre><p>Estimate the ARXAR model <code>Ay = Bu + v</code>, where <code>v = He</code> and <code>H = 1/D</code>, using generalized least-squares method. For more information see Söderström - Convergence properties of the generalized least squares identification method, 1974. </p><p><strong>Arguments:</strong></p><ul><li><code>d</code>: iddata</li><li><code>na</code>: order of A</li><li><code>nb</code>: number of coefficients in B, the order is determined by <code>nb + inputdelay - 1</code>. In MISO estimation it takes the form <code>nb = [nb₁, nb₂...]</code>. </li><li><code>nd</code>: order of D</li></ul><p><strong>Keyword Arguments:</strong></p><ul><li><code>H = nothing</code>: prior knowledge about the AR noise model</li><li><code>inputdelay = ones(Int, size(nb))</code>: optional delay of input, inputdelay = 0 results in a direct term, takes the form inputdelay = [d₁, d₂...] in MISO estimation </li><li><code>λ = 0</code>: <code>λ &gt; 0</code> can be provided for L₂ regularization</li><li><code>estimator = \</code>: e.g. <code>\,tls,irls,rtls</code>, the latter three require <code>using TotalLeastSquares</code></li><li><code>δmin = 10e-4</code>: Minimal change in the power of e, that specifies convergence.</li><li><code>iterations = 10</code>: maximum number of iterations.</li><li><code>verbose = false</code>: if true, more information is printed</li></ul><p>See also <a href="#ControlSystemIdentification.plr"><code>plr</code></a>, <a href="#ControlSystemIdentification.arx"><code>arx</code></a>.</p><p><strong>Example:</strong></p><pre><code class="nohighlight hljs">julia&gt; N = 500 
500

julia&gt; sim(G, u) = lsim(G, u, 1:N)[1][:]
sim (generic function with 1 method)

julia&gt; A = tf([1, -0.8], [1, 0], 1)
TransferFunction{Discrete{Int64}, ControlSystemsBase.SisoRational{Float64}}
1.0z - 0.8
----------
   1.0z

Sample Time: 1 (seconds)
Discrete-time transfer function model

julia&gt; B = tf([0, 1], [1, 0], 1)
TransferFunction{Discrete{Int64}, ControlSystemsBase.SisoRational{Int64}}
1
-
z

Sample Time: 1 (seconds)
Discrete-time transfer function model

julia&gt; G = minreal(B / A)
TransferFunction{Discrete{Int64}, ControlSystemsBase.SisoRational{Float64}}
   1.0
----------
1.0z - 0.8

Sample Time: 1 (seconds)
Discrete-time transfer function model

julia&gt; D = tf([1, 0.7], [1, 0], 1)
TransferFunction{Discrete{Int64}, ControlSystemsBase.SisoRational{Float64}}
1.0z + 0.7
----------
   1.0z

Sample Time: 1 (seconds)
Discrete-time transfer function model

julia&gt; H = 1 / D
TransferFunction{Discrete{Int64}, ControlSystemsBase.SisoRational{Float64}}
   1.0z
----------
1.0z + 0.7

Sample Time: 1 (seconds)
Discrete-time transfer function model

julia&gt; u, e = randn(1, N), randn(1, N)
[...]

julia&gt; y, v = sim(G, u), sim(H * (1/A), e) # simulate process
[...]

julia&gt; d = iddata(y .+ v, u, 1)
InputOutput data of length 500 with 1 outputs and 1 inputs

julia&gt; na, nb , nd = 1, 1, 1
(1, 1, 1)

julia&gt; Gest, Hest, res = arxar(d, na, nb, nd)
(G = TransferFunction{Discrete{Int64}, ControlSystemsBase.SisoRational{Float64}}
   0.9987917259291642
-------------------------
1.0z - 0.7937837464682017

Sample Time: 1 (seconds)
Discrete-time transfer function model, H = TransferFunction{Discrete{Int64}, ControlSystemsBase.SisoRational{Float64}}
          1.0z
-------------------------
1.0z + 0.7019519225937721

Sample Time: 1 (seconds)
Discrete-time transfer function model, e = [...]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/b79b5805b90329f11b8418827dfef527675483ca/src/arx.jl#L297-L399">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ControlSystemIdentification.getARXregressor" href="#ControlSystemIdentification.getARXregressor"><code>ControlSystemIdentification.getARXregressor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getARXregressor(y::AbstractVector,u::AbstractVecOrMat, na, nb; inputdelay = ones(Int, size(nb)))</code></pre><p>Returns a shortened output signal <code>y</code> and a regressor matrix <code>A</code> such that the least-squares ARX model estimate of order <code>na,nb</code> is <code>y\A</code></p><p>Return a regressor matrix used to fit an ARX model on, e.g., the form <code>A(z)y = B(z)u</code> with output <code>y</code> and input <code>u</code> where the order of autoregression is <code>na</code>, the order of input moving average is <code>nb</code> and an optional input delay <code>inputdelay</code>. Caution, changing the input delay changes the order to <code>nb + inputdelay - 1</code>. An <code>inputdelay = 0</code> results in a direct term. </p><p><strong>Example</strong></p><pre><code class="language-julia hljs">A     = [1,2*0.7*1,1] # A(z) coeffs
B     = [10,5] # B(z) coeffs
u     = randn(100) # Simulate 100 time steps with Gaussian input
y     = filt(B,A,u)
yr,A  = getARXregressor(y,u,3,2) # We assume that we know the system order 3,2
x     = A\yr # Estimate model polynomials
plot([yr A*x], lab=[&quot;Signal&quot; &quot;Prediction&quot;])</code></pre><p>For nonlinear ARX-models, see <a href="https://github.com/baggepinnen/BasisFunctionExpansions.jl/">BasisFunctionExpansions.jl</a>. See also <code>arx</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/b79b5805b90329f11b8418827dfef527675483ca/src/arx.jl#L1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ControlSystemIdentification.getARregressor" href="#ControlSystemIdentification.getARregressor"><code>ControlSystemIdentification.getARregressor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">yt,A = getARregressor(y::AbstractVector, na)</code></pre><p>Returns values such that <code>x = A\yt</code>. See <a href="#ControlSystemIdentification.getARXregressor"><code>getARXregressor</code></a> for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/baggepinnen/ControlSystemIdentification.jl/blob/b79b5805b90329f11b8418827dfef527675483ca/src/arx.jl#L53-L57">source</a></section></article><h2 id="Video-tutorials"><a class="docs-heading-anchor" href="#Video-tutorials">Video tutorials</a><a id="Video-tutorials-1"></a><a class="docs-heading-anchor-permalink" href="#Video-tutorials" title="Permalink"></a></h2><p>Video tutorials performing transfer-function estimation are available here:</p><iframe style="height: 315px; width: 560px" src="https://www.youtube.com/embed/ljrGtJPzlRk?si=CyJnGrRQ-qA6Wwf-" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ss/">« State-space estimation</a><a class="docs-footer-nextpage" href="../impulse/">Impulse-response estimation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Saturday 24 August 2024 05:14">Saturday 24 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
